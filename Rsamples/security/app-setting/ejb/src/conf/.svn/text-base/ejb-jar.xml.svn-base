<?xml version="1.0" encoding="UTF-8"?>

<ejb-jar xmlns="http://java.sun.com/xml/ns/j2ee" version="3.0">
		<display-name>SecuritySample</display-name>
		<enterprise-beans>
				<session>
						<ejb-name>public</ejb-name>
						<business-remote>ejbwork.PublicCall</business-remote>
						<ejb-class>ejbwork.PublicCallBean</ejb-class>
						<session-type>Stateless</session-type>
						<security-role-ref>
								<role-name>pub</role-name>
								<role-link>ejbrole</role-link>
						</security-role-ref>
				</session>
				<session>
						<ejb-name>admin</ejb-name>
						<business-remote>ejbwork.Admin</business-remote>
						<ejb-class>ejbwork.AdminBean</ejb-class>
						<session-type>Stateless</session-type>
						<security-role-ref>
								<role-name>admin</role-name>
								<role-link>ejbrole</role-link>
						</security-role-ref>
				</session>
				<session>
						<ejb-name>secret</ejb-name>
						<business-remote>ejbwork.Secret</business-remote>
						<ejb-class>ejbwork.SecretBean</ejb-class>
						<session-type>Stateless</session-type>
						<security-role-ref>
								<role-name>hidden</role-name>
								<role-link>ejbrole</role-link>
						</security-role-ref>
				</session>
		</enterprise-beans>
		
		<assembly-descriptor>
				<security-role>
						<role-name>ejbrole</role-name>
				</security-role>
				<security-role>
						<role-name>laboratory</role-name>
				</security-role>
				<method-permission>
						<role-name>ejbrole</role-name>
						<method>
								<ejb-name>admin</ejb-name>
								<method-name>message</method-name>
						</method>
				</method-permission>
				<method-permission>
						<role-name>laboratory</role-name>
						<method>
								<ejb-name>secret</ejb-name>
								<method-name>message</method-name>
						</method>
				</method-permission>
				<exclude-list>
						<method>
								<ejb-name>secret</ejb-name>
								<method-name>excludedMSG</method-name>
						</method>
				</exclude-list>
		</assembly-descriptor>
</ejb-jar>				