<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE page-specification PUBLIC
  "-//Apache Software Foundation//Tapestry Specification 4.0//EN" 
  "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">

<page-specification class="jeus.tool.webadmin.page.FolderApplicationModule.DeployPage">
    
    <component id="mainBorder" type="jeus:MainBorder">
        <binding name="title" value="literal:Deploy New Application Module"/>
    </component>

    <component id="wizTabPanel" type="jeus:WizardTabPanel">
        <binding name="tabNames" value="new java.lang.String[]{'select','targets','options', 'deploy', 'result'}"/>
    </component>

    <component id="module_tabpanel" type="jeus:InnerTabPanel">
        <binding name="model" value="moduleTabModel"/>
    </component>

    <component id="module_selection_tabpanel" type="jeus:InnerTabPanel">
        <binding name="model" value="new jeus.tool.webadmin.component.GeneralTabModel(new java.lang.String[]{'amd.select.existing_module_tab.apphome.label','amd.select.existing_module_tab.selected_dir.label'}, new java.lang.String[]{'module_at_apphome', 'module_at_selected_dir'})"/>
    </component>

    <component id="module_at_apphomeForm" type="jeus:JEUSForm">
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="apphome_module" type="jeus:Field">
        <binding name="layout" value="@jeus.tool.webadmin.component.Field3@EXTENDED_LAYOUT"/>
    </component>

    <component id="apphome_moduleField" type="jeus:ModuleExplorer">
        <binding name="model" value="apphomeModuleExplorerModel"/>
        <binding name="selectedModel" value="apphomeModuleExplorerSelectionModel"/>
    </component>

    <component id="module_at_selected_dirForm" type="jeus:JEUSForm">
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="explorer" type="jeus:Field">
        <binding name="label" value="literal:"/>
        <binding name="layout" value="@jeus.tool.webadmin.component.Field3@EXTENDED_LAYOUT"/>
    </component>

    <component id="explorerField" type="jeus:FileExplorer">
        <binding name="model" value="fileExplorerModel"/>
        <binding name="currentPath" value="currentPath"/>
    </component>

    <component id="module" type="jeus:Field">
        <binding name="layout" value="@jeus.tool.webadmin.component.Field3@EXTENDED_LAYOUT"/>
    </component>

    <component id="moduleField" type="jeus:ModuleExplorer">
        <binding name="model" value="moduleExplorerModel"/>
        <binding name="selectedModel" value="moduleExplorerSelectionModel"/>
    </component>

    <component id="appHomeModuleNext" type="Submit">
        <binding name="value" value="message:common.label.next"/>
        <binding name="listener" value="listener:onApphomeModuleNext"/>
    </component>

    <component id="moduleNext" type="Submit">
        <binding name="value" value="message:common.label.next"/>
        <binding name="listener" value="listener:onModuleNext"/>
    </component>

    <component id="absolute_pathForm" type="jeus:JEUSForm">
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="absolute_path" type="jeus:Field">
        <binding name="field" value="component:absolutePathField"/>
        <binding name="label" value="message:amd.select.absolute_path.label"/>
    </component>

    <component id="absolutePathField" type="TextField">
        <binding name="value" value="absolutePath"/>
    </component>

    <component id="absolute_pathNext" type="Submit">
        <binding name="value" value="message:common.label.next"/>
        <binding name="listener" value="listener:onAbsolutePathNext"/>
    </component>                             
  
    <component id="versionForm" type="jeus:JEUSForm">
        <binding name="useDefaultButtons" value="false"/>
        <binding name="listener" value="listener:onVersionCTLNext"/>
    </component>

    <component id="vupload" type="jeus:Field">
        <binding name="field" value="component:uploadField"/>
        <binding name="label" value="message:amd.select.upload_file.label"/>
    </component>

    <component id="vuploadField" type="Upload">
        <binding name="file" value="uploadFile"/>
        <!--<binding name="disabled" value="!containerCreated or !objectName.keyPropertyList.J2EEServer.startsWith(objectName.keyPropertyList.JeusManager)"/>-->
        <binding name="disabled" value="!containerCreated"/>
    </component>

    <component id="enabledVersion" type="jeus:Field">
        <binding name="field" value="component:enabledVersionField"/>
        <binding name="label" value="message:amd.select.enabled_version.label"/>
        <binding name="description" value="message:amd.select.enabled_version.description"/>
    </component>

    <component id="enabledVersionField" type="Checkbox">
        <binding name="value" value="enabledVersion"/>
    </component>
    
    <component id="modified" type="jeus:Field">
        <binding name="field" value="component:modifiedField"/>
        <binding name="label" value="message:amd.version.control.modified"/>
    </component>

    <component id="modifiedField" type="TextField">
        <binding name="value" value="modifiedContent"/>
    </component>    
  
    <component id="uploadForm" type="jeus:JEUSForm">
        <binding name="useDefaultButtons" value="false"/>
        <binding name="listener" value="listener:onUploadNext"/>
    </component>

    <component id="upload" type="jeus:Field">
        <binding name="field" value="component:uploadField"/>
        <binding name="label" value="message:amd.select.upload_file.label"/>
    </component>

    <component id="uploadField" type="Upload">
        <binding name="file" value="uploadFile"/>
        <!--<binding name="disabled" value="!containerCreated or !objectName.keyPropertyList.J2EEServer.startsWith(objectName.keyPropertyList.JeusManager)"/>-->
        <!-- 
        <binding name="disabled" value="!containerCreated"/>
         -->
    </component>

    <component id="upload_target" type="jeus:Field">
        <binding name="field" value="component:upload_targetField"/>
        <binding name="label" value="message:amd.select.upload_target.label"/>
    </component>

    <component id="upload_targetField" type="PropertySelection">
        <binding name="value" value="uploadTargetPath"/>
        <binding name="model" value="uploadTargetModel"/>
    </component>

    <component id="targetsForm" type="jeus:JEUSForm">
        <binding name="title" value="message:amd.targets.title"/>
        <binding name="description" value="message:amd.targets.description"/>
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="noTargetsForm" type="jeus:JEUSForm">
        <binding name="title" value="message:amd.targets.title"/>
        <binding name="description" value="message:amd.targets.description"/>
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="targetsField" type="jeus:TargetExplorer">
    	<binding name="label" value="message:amd.targets.targets.label"/>
        <binding name="model" value="targetExplorerModel"/>
        <binding name="selectionModel" value="targetExplorerSelectionModel"/>
        <binding name="useOption" value="renderContextGroup"/>
        <binding name="optionLabel" value="message:amd.targets.context_group.label"/>
        <binding name="optionLabel2" value="message:amd.targets.virtual_host.label"/>
    </component>

    <component id="condNoTarget" type="If">
        <binding name="condition" value="targetExplorerModel == null"/>
    </component>

    <component id="noTarget" type="Insert">
        <binding name="value" value="message:common.exception.0041"/>
    </component>

    <component id="targetsPrevious" type="Submit">
        <binding name="value" value="message:common.label.previous"/>
        <binding name="listener" value="listener:onTargetsPrevious"/>
    </component>

    <component id="targetsPrevious2" copy-of="targetsPrevious"/>

    <component id="targetsNext" type="Submit">
        <binding name="value" value="message:common.label.next"/>
        <binding name="listener" value="listener:onTargetsNext"/>
    </component>

    <component id="componentsField" type="jeus:InnerTabPanel">
        <binding name="model" value="tabModel"/>
        <binding name="sessionSave" value="true"/>
    </component>

	<component id="ejb_componentFormSection" type="jeus:FormSection">
		<binding name="title" value="message:amd.options.ejb_component.title"/>
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:ejb-component"/>
	</component>
	

    <component id="keep_generated" type="jeus:Field">
        <binding name="field" value="component:keep_generatedField"/>
    </component>

    <component id="keep_generatedField" type="jeus:JAXBCheckbox">
        <binding name="parentElement" value="component"/>
        <binding name="elementName" value="literal:keepGenerated"/>
    </component>

    <component id="client_view_path" type="jeus:Field">
        <binding name="field" value="component:client_view_pathField"/>
    </component>

    <component id="client_view_pathField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="component"/>
        <binding name="elementName" value="literal:clientViewPath"/>
    </component>

    <component id="contextRoot" type="jeus:Field">
    	<binding name="field" value="component:contextRootField"/>
    </component>
    
    <component id="contextRootField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="component"/>
        <binding name="elementName" value="literal:contextRoot"/>
    </component>

	<component id="web_componentFormSection" type="jeus:FormSection">
        <binding name="title" value="message:amd.options.web_component.title"/>
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:web-component"/>
	</component>
	

    <component id="session_timeout" type="jeus:Field">
        <binding name="field" value="component:session_timeoutField"/>
        <binding name="unit" value="message:common.unit.minutes"/>
    </component>

    <component id="session_timeoutField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="component"/>
        <binding name="elementName" value="literal:sessionTimeout"/>
		<binding name="translator" value="translator:number2"/>
        <binding name="validators" value="validators:min=-1"/>        
    </component>       

    <component id="uri" type="jeus:ReadOnlyTextField">
        <binding name="parentElement" value="component"/>
        <binding name="elementName" value="literal:uri"/>
    </component>
    
	<component id="client_componentFormSection" type="jeus:FormSection">
        <binding name="title" value="message:amd.options.client_component.title"/>
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:client-component"/>
	</component>

    
	<component id="connector_componentFormSection" type="jeus:FormSection">
        <binding name="title" value="message:amd.options.connector_component.title"/>
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:connector-component"/>
	</component>

	<component id="check_java_permission" type="jeus:ExtendedCheckbox">
		<binding name="value" value="securityPermissionCheck2"/>
		<binding name="parentElement" value="component"/>
        <binding name="elementName" value="literal:javaSecurityPermission"/>
	</component>
	
    <component id="java_permission_description" type="jeus:Field">
        <binding name="field" value="component:java_permission_descriptionField"/>
    </component>

    <component id="java_permission_descriptionField" type="jeus:JAXBTextArea">
        <binding name="parentElement" value="securityPermission"/>
        <binding name="elementName" value="literal:description"/>
        <binding name="disabled" value="!securityPermissionCheck2"/>               
    </component>

    <component id="java_permission_spec" type="jeus:Field">
        <binding name="field" value="component:java_permission_specField"/>
    </component>

    <component id="java_permission_specField" type="jeus:JAXBTextArea">
        <binding name="parentElement" value="securityPermission"/>
        <binding name="elementName" value="literal:securityPermissionSpec"/>
        <binding name="validators" value="validators:required"/>
        <binding name="disabled" value="!securityPermissionCheck2"/>           
    </component>                        	                        
    

    <component id="app_keep_generated" type="jeus:Field">
        <binding name="field" value="component:app_keep_generatedField"/>
    </component>

    <component id="app_keep_generatedField" type="jeus:JAXBCheckbox">
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:keepGenerated"/>
    </component>

 	<component id="check_java_security_permission" type="jeus:ExtendedCheckbox">
		<binding name="value" value="javaSecurityPermissionCheck"/>
		<binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:javaSecurityPermission"/>
	</component>
	
    <component id="security_permission_description" type="jeus:Field">
        <binding name="field" value="component:security_permission_descriptionField"/>
    </component>

    <component id="security_permission_descriptionField" type="jeus:JAXBTextArea">
        <binding name="parentElement" value="javaSecurityPermission"/>
        <binding name="elementName" value="literal:description"/>
        <binding name="disabled" value="!javaSecurityPermissionCheck"/>        
    </component>

    <component id="security_permission_spec" type="jeus:Field">
        <binding name="field" value="component:security_permission_specField"/>
    </component>

    <component id="security_permission_specField" type="jeus:JAXBTextArea">
        <binding name="parentElement" value="javaSecurityPermission"/>
        <binding name="elementName" value="literal:securityPermissionSpec"/>
        <binding name="validators" value="validators:required"/>
        <binding name="disabled" value="!javaSecurityPermissionCheck"/>                
    </component>

    <component id="fast_deploy" type="jeus:Field">
        <binding name="field" value="component:fast_deployField"/>
    </component>

    <component id="fast_deployField" type="jeus:JAXBCheckbox">
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:fastDeploy"/>
    </component>

    <component id="deploy_when_booting" type="jeus:Field">
        <binding name="field" value="component:deploy_when_bootingField"/>
    </component>

    <component id="deploy_when_bootingField" type="jeus:JAXBCheckbox">
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:deployWhenBooting"/>
        <binding name="disabled" value="autodeploySelected"/>
    </component>

    <component id="class_ftp_unit" type="jeus:Field">
        <binding name="field" value="component:class_ftp_unitField"/>
    </component>

    <component id="class_ftp_unitField" type="jeus:JAXBPropertySelection">
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:classFtpUnit"/>
        <binding name="model" value="@jeus.tool.webadmin.page.EnumerationSet@getEnumPropertySelectionModel(@jeus.xml.binding.jeusDD.ClassFtpUnitType@class)"/>
        <binding name="defaultWrite" value="true"/>
    </component>

    <component id="security_domain_name" type="jeus:Field">
        <binding name="field" value="component:security_domain_nameField"/>
    </component>

    <component id="security_domain_nameField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:securityDomainName"/>
    </component>

 <!--    <component id="role_permission" type="jeus:Field">
        <binding name="field" value="component:role_permissionField"/>
    </component>

   <component id="role-permissionField" type="jeus:JAXBTextArea">
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:securityPermissionSpec"/>
    </component>    -->

<!--    <component id="alias_name" type="jeus:Field">
        <binding name="field" value="component:alias_nameField"/>
    </component>

    <component id="alias_nameField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:name"/>
    </component>-->

 	<component id="check_autodeploy" type="jeus:ExtendedCheckbox">
		<binding name="value" value="autoDeployCheck"/>
		<binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:autoDeploy"/>
        <binding name="disabled" value="autodeploySelected"/>
	</component>
	
    <component id="check_absolute_path" type="jeus:Field">
        <binding name="field" value="component:check_absolute_pathField"/>
    </component>

    <component id="check_absolute_pathField" type="jeus:JAXBCheckbox">
        <binding name="parentElement" value="autoDeploy"/>
        <binding name="elementName" value="literal:checkAbsolutePath"/>
        <binding name="disabled" value="!autoDeployCheck or autodeploySelected"/>
    </component>

    <component id="auto_deploy" type="jeus:Field">
        <binding name="field" value="component:auto_deployField"/>
        <binding name="unit" value="message:common.unit.msec"/>
    </component>

    <component id="auto_deployField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="autoDeploy"/>
        <binding name="elementName" value="literal:autoDeployCheckInterval"/>
        <binding name="translator" value="translator:number2,valueType=Long"/>
        <binding name="validators" value="validators:min=1"/>
        <binding name="disabled" value="!autoDeployCheck"/>        
    </component>

    <component id="classloading" type="jeus:Field">
        <binding name="field" value="component:classloadingField"/>
    </component>

    <component id="classloadingField" type="jeus:JAXBPropertySelection">
        <binding name="parentElement" value="application"/>
        <binding name="elementName" value="literal:classloading"/>
        <binding name="model" value="@jeus.tool.webadmin.page.EnumerationSet@getEnumPropertySelectionModel(@jeus.xml.binding.jeusDD.ClassloadingType@class, true)"/>
    </component>

    <component id="optionsPrevious" type="Submit">
        <binding name="value" value="message:common.label.previous"/>
        <binding name="listener" value="listener:onOptionsPrevious"/>
    </component>
    
    <component id="optionsPrevious2" copy-of="optionsPrevious"></component>

    <component id="optionsNext" type="Submit">
        <binding name="value" value="message:common.label.next"/>
        <binding name="listener" value="listener:onOptionsNext"/>
    </component>
    
    <component id="optionsNext2" copy-of="optionsNext"></component>

    <component id="deployForm" type="jeus:JEUSForm">
        <binding name="title" value="message:amd.deploy.title"/>
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="permanentDeployForm" type="jeus:JEUSForm">
        <binding name="title" value="message:amd.select.title"/>
        <binding name="description" value="autodeploySelected ? messages.getMessage('amd.deploy.permanent_deploy.description3') : messages.getMessage('amd.deploy.permanent_deploy.description2')"/>
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="condContainerCreated" type="If">
        <binding name="condition" value="containerCreated and !autodeploySelected"/>
        <binding name="renderTag" value="false"/>
    </component>

    <component id="runtimeDeploy" type="jeus:Field">
        <binding name="field" value="component:runtimeDeployField"/>
        <binding name="label" value="message:amd.deploy.runtime.deploy.label"/>
        <binding name="description" value="message:amd.deploy.runtime.deploy.description"/>
    </component>

    <component id="runtimeDeployField" type="Checkbox">
        <binding name="value" value="runtimeDeploy"/>
    </component>
 
    <component id="permanentDeploy" type="jeus:Field">
        <binding name="field" value="component:permanentDeployField"/>
        <binding name="label" value="message:amd.deploy.permanent_deploy.label"/>
        <binding name="description" value="message:amd.deploy.permanent_deploy.description"/>
    </component>

    <component id="permanentDeployField" type="Checkbox">
        <binding name="value" value="permanentDeploy"/>
    </component>

    <component id="deployPrevious" type="Submit">
        <binding name="value" value="message:common.label.previous"/>
        <binding name="listener" value="listener:onDeployPrevious"/>
    </component>

    <component id="deployPrevious2" copy-of="deployPrevious"/>

    <component id="deploySubmit" type="Submit">
        <binding name="value" value="message:amd.deploy.deploy.label"/>
        <binding name="listener" value="listener:onDeployOk"/>
    </component>

    <component id="deploySubmit2" type="Submit">
        <binding name="value" value="message:amd.deploy.deploy.label"/>
        <binding name="listener" value="listener:onPermanentDeployOk"/>
    </component>

    <component id="resultForm" type="jeus:JEUSForm">
        <binding name="title" value="message:amd.result.title"/>
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="condCompleted" type="If">
        <binding name="condition" value="completedList != null and completedList.size &gt; 0"/>
    </component>

    <component id="condFailed" type="If">
        <binding name="condition" value="failedList != null and failedList.size &gt; 0"/>
    </component>

    <component id="completedSection" type="jeus:FormSection">
        <binding name="title" value="message:amd.result.completed.label"/>
    </component>

    <component id="completed" type="jeus:Field">
        <binding name="label" value="''"/>
        <binding name="layout" value="@jeus.tool.webadmin.component.Field3@EXTENDED_LAYOUT"/>
    </component>

    <component id="eachCompletedTarget" type="For">
        <binding name="source" value="completedList"/>
        <binding name="value" value="target"/>
    </component>

    <component id="completedTarget" type="Insert">
        <binding name="value" value="'- ' + target"/>
    </component>

    <component id="failedSection" type="jeus:FormSection">
        <binding name="title" value="message:amd.result.failed.label"/>
    </component>

    <component id="failed" type="jeus:Field">
        <binding name="label" value="''"/>
        <binding name="layout" value="@jeus.tool.webadmin.component.Field3@EXTENDED_LAYOUT"/>
    </component>

    <component id="eachFailedTarget" type="For">
        <binding name="source" value="failedList"/>
        <binding name="value" value="target"/>
    </component>

    <component id="failure" type="jeus:ErrorMessageBox">
        <binding name="message" value="'- '+target"/>
        <binding name="messageClass" value="literal:normal_text"/>
        <binding name="detailMessage" value="failures != null and failures.get(target) != null ? failures.get(target).description : null"/>
        <binding name="detailMessageClass" value="literal:form_fail_detail_message"/>
        <binding name="buttonClass" value="literal:form_button"/>
        <binding name="rows" value="20"/>
    </component>

    <property name="target"/>
    <property name="runtimeDeploy" initial-value="true"/>
    
    <asset name="edit1" path="context:/image/but_edit_01.gif"/>
    <asset name="edit2" path="context:/image/but_edit_02.gif"/>
    
	<asset name="ear" path="context:/image/mbean/ear_running.gif"/>
	<asset name="ejb" path="context:/image/mbean/ejb_module_running.gif"/>
	<asset name="ca" path="context:/image/mbean/ca_module_running.gif"/>
	<asset name="ra" path="context:/image/mbean/ra_module_running.gif"/>
	<asset name="war" path="context:/image/mbean/web_module_running.gif"/>			
	<asset name="empty" path="context:/image/field_error.gif"/>

    <component id="wtbBlockTypeField" type="PropertySelection">
        <binding name="value" value="wtbBlockType"/>
        <binding name="model" value="@jeus.tool.webadmin.page.EnumerationSet@getPropertySelectionModel({'each','half','1:overflow','all'})"/>
    </component>
</page-specification>