<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE page-specification PUBLIC
  "-//Apache Software Foundation//Tapestry Specification 4.0//EN" 
  "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">

<page-specification class="jeus.tool.webadmin.page.J2EEServer.CreatePage">
    
    <component id="mainBorder" type="jeus:MainBorder">
        <binding name="title" value="message:dsc.title"/>
        <binding name="helpParameter" value="duplicate ? 'duplicate' : 'create'"/>
    </component>

    <component id="wizTabPanel" type="jeus:WizardTabPanel">
        <binding name="tabNames" value="new java.lang.String[]{'create'}"/>
    </component>

    <component id="create" type="Block"/>

    <component id="createForm" type="jeus:JEUSForm">
        <binding name="title" value="duplicate ? messages.getMessage('container.duplicate.title') :messages.getMessage('container.create.title')"/>
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="createOk" type="Submit">
        <binding name="value" value="message:common.label.create"/>
        <binding name="listener" value="listener:onCreateOk"/>
    </component>

    <component id="createOk2" copy-of="createOk"/>

    <component id="container_name" type="jeus:Field">
        <binding name="field" value="component:container_nameField"/>
    </component>

    <component id="container_nameField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="engineContainer"/>
        <binding name="elementName" value="literal:name"/>
		<binding name="translator" value="bean:containerNameTranslator"/>        
        <binding name="validators" value="validators:required,$pattern,$containerNameValidator"/>
    </component>
    
    <bean name="pattern" class="org.apache.tapestry.form.validator.Pattern">
    	<set name="pattern" value="literal:[a-zA-Z0-9]*"/>
    	<set name="message" value="message:common.exception.0066"/>
    </bean>

    <component id="id" type="jeus:Field">
        <binding name="field" value="component:idField"/>
    </component>

    <component id="idField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="engineContainer"/>
        <binding name="elementName" value="literal:id"/>
        <binding name="validators" value="validators:$containerIdValidator"/>
    </component>

    <component id="baseport" type="jeus:Field">
        <binding name="field" value="component:baseportField"/>
    </component>

    <component id="baseportField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="engineContainer"/>
        <binding name="elementName" value="literal:basePort"/>
        <binding name="validators" value="validators:$containerBaseportValidator"/>
    </component>

    <component id="condDuplicate" type="If">
        <binding name="condition" value="duplicate"/>
    </component>

    <component id="condEJB" type="If">
        <binding name="condition" value="engineCommand.type == @jeus.xml.binding.jeusDD.EngineTypeType@EJB"/>
    </component>

    <component id="condWEB" type="If">
        <binding name="condition" value="engineCommand.type == @jeus.xml.binding.jeusDD.EngineTypeType@SERVLET"/>
    </component>

    <component id="condJMS" type="If">
        <binding name="condition" value="engineCommand.type == @jeus.xml.binding.jeusDD.EngineTypeType@JMS"/>
    </component>

    <component id="engines" type="For">
        <binding name="source" value="engineContainer.engineCommand"/>
        <binding name="value" value="engineCommand"/>
    </component>

    <component id="ejb_name" type="jeus:Field">
        
        <binding name="label" value="message:container.create.ejb_name.label"/>
        <binding name="field" value="component:ejb_nameField"/>
    </component>

    <component id="ejb_nameField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="engineCommand"/>
        <binding name="elementName" value="literal:name"/>
		<binding name="translator" value="bean:ejbNameTranslator"/>        
        <binding name="validators" value="validators:required,pattern=\w*[%common.exception.0066],$ejbNameValidator"/>
    </component>

    <component id="servlet_name" type="jeus:Field">
        
        <binding name="label" value="message:container.create.servlet_name.label"/>
        <binding name="field" value="component:servlet_nameField"/>
    </component>

    <component id="servlet_nameField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="engineCommand"/>
        <binding name="elementName" value="literal:name"/>
		<binding name="translator" value="bean:servletNameTranslator"/>        
        <binding name="validators" value="validators:required,pattern=\w*[%common.exception.0066],$servletNameValidator"/>
    </component>

    <component id="jms_name" type="jeus:Field">
        
        <binding name="label" value="message:container.create.jms_name.label"/>
        <binding name="field" value="component:jms_nameField"/>
    </component>

    <component id="jms_nameField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="engineCommand"/>
        <binding name="elementName" value="literal:name"/>
		<binding name="translator" value="bean:jmsNameTranslator"/>        
        <binding name="validators" value="validators:required,pattern=\w*[%common.exception.0066],$jmsNameValidator"/>
    </component>

    <component id="enginesSection" type="jeus:FormSection">
        <binding name="title" value="message:container.create.engines.title"/>
        <!--<binding name="description" value="message:container.create.engines.description"/>-->
    </component>

    <component id="condCreation" type="If">
        <binding name="condition" value="!duplicate"/>
        <binding name="renderTag" value="false"/>
    </component>

    <component id="enginesCreationSection" type="jeus:FormSection">
        <binding name="title" value="message:container.create.engines.title"/>
        <binding name="description" value="message:container.create.engines.description"/>
    </component>

    <component id="ejb_engine_nameField" type="TextField">
        <binding name="value" value="ejbEngName"/>
        <!--<binding name="displayName" value="message:container.create.ejb_name.label"/>-->
        <binding name="displayName" value="literal:"/>
		<binding name="translator" value="bean:ejbEngNameTranslator"/>        
        <binding name="validators" value="validators:pattern=\w*[%common.exception.0066],$ejbEngNameValidator"/>
    </component>

    <component id="ejb_engine_createField" type="Checkbox">
        <binding name="value" value="createEjbEngine"/>
    </component>

    <component id="ejb_engine_label" type="Insert">
        <binding name="value" value="message:container.create.ejb_engine.label"/>
    </component>

    <component id="servlet_engine_nameField" type="TextField">
        <binding name="value" value="servletEngName"/>
        <!--<binding name="displayName" value="message:container.create.servlet_name.label"/>-->
        <binding name="displayName" value="literal:"/>
		<binding name="translator" value="bean:servletEngNameTranslator"/>        
        <binding name="validators" value="validators:pattern=\w*[%common.exception.0066],$servletEngNameValidator"/>
    </component>

    <component id="servlet_engine_label" type="Insert">
        <binding name="value" value="message:container.create.servlet_engine.label"/>
    </component>

    <component id="servlet_listener_portField" type="TextField">
        <binding name="value" value="listenerPort"/>
        <binding name="displayName" value="message:container.create.servlet.listener_port.label"/>
        <binding name="translator" value="translator:number2,valueType=Long"/>
        <binding name="validators" value="validators:min=1"/>
        <binding name="disabled" value="!createServletEngine"/>
    </component>

    <component id="servlet_listener_idField" type="TextField">
        <binding name="value" value="listenerId"/>
        <binding name="displayName" value="message:container.create.servlet.listener_id.label"/>
        <!--<binding name="validator" value="bean:listenerIdValidator"/>-->
		<binding name="disabled" value="!createServletEngine"/>
    </component>

    <component id="servlet_engine_createField" type="Checkbox">
        <binding name="value" value="createServletEngine"/>
    </component>
    
    <component id="servlet_engine_script" type="Script">
    	<binding name="script" value="literal:/jeus/tool/webadmin/script/Checkbox.script"/>
    	<binding name="source" value="component:servlet_engine_createField"/>
    	<binding name="targets" value="{components.servlet_listener_portField, components.servlet_listener_idField}"/>
    </component>

    <component id="jms_engine_nameField" type="TextField">
        <binding name="value" value="jmsEngName"/>
        <binding name="displayName" value="message:container.create.jms_name.label"/>
		<binding name="translator" value="bean:jmsEngNameTranslator"/>        
        <binding name="validators" value="validators:pattern=\w*[%common.exception.0066],$jmsEngNameValidator"/>
    </component>


    <component id="jms_engine_label" type="Insert">
        <binding name="value" value="message:container.create.jms_engine.label"/>
    </component>

    <component id="jms_channel_nameField" type="TextField">
        <binding name="value" value="jmsChannelName"/>
        <binding name="displayName" value="message:container.create.jms.channel_name.label"/>
        <binding name="disabled" value="!createJmsEngine"/>
    </component>
    
    <component id="jms_channel_portField" type="TextField">
    	<binding name="value" value="jmsChannelPort"/>
    	<binding name="displayName" value="message:container.create.jms.channel_port.label"/>
        <binding name="disabled" value="!createJmsEngine"/>   
        <binding name="translator" value="translator:number2"/>
        <binding name="validators" value="validators:min=1"/>	
    </component>

    <component id="jms_engine_createField" type="Checkbox">
        <binding name="value" value="createJmsEngine"/>
    </component>

    <component id="jms_engine_script" type="Script">
    	<binding name="script" value="literal:/jeus/tool/webadmin/script/Checkbox.script"/>
    	<binding name="source" value="component:jms_engine_createField"/>
    	<binding name="targets" value="{components.jms_channel_nameField, components.jms_channel_portField}"/>
    </component>

    <component id="creationColumn" type="Insert">
        <binding name="value" value="message:container.create.creation.label"/>
    </component>

    <component id="engineTypeColumn" type="Insert">
        <binding name="value" value="message:container.create.engine_type.label"/>
    </component>

    <component id="engineNameColumn" type="Insert">
        <binding name="value" value="message:container.create.engine_name.label"/>
    </component>

    <component id="Id_or_NameColumn" type="Insert">
        <binding name="value" value="message:container.create.ip_or_name.label"/>
    </component>

    <component id="portColumn" type="Insert">
        <binding name="value" value="message:container.create.port.label"/>
    </component>
<!--
    <component id="creationCheck" type="Checkbox">
        <binding name="value" value="createEngines"/>
    </component>

    <component id="engineIcon" type="Image">
        <binding name="image" value="getEngineIcon(engineType)"/>
    </component>

    <component id="engineName" type="Insert">
        <binding name="value" value="engineName"/>
    </component>

    <component id="listenerId_or_channelName" type="Insert">
        <binding name="value" value="engineName"/>
    </component>

    <component id="port" type="Insert">
        <binding name="value" value="engineName"/>
    </component>
-->

    <bean name="containerNameValidator" class="jeus.tool.webadmin.page.J2EEServer.ContainerNameValidator">
        <set name="node" value="node"/>
    </bean>

	<bean name="containerNameTranslator" class="jeus.tool.webadmin.translator.DefaultStringTranslator">
		<set name="default" value="beans.containerNameValidator.generateName()"/>
	</bean>
	
    <bean name="containerIdValidator" class="jeus.tool.webadmin.page.J2EEServer.ContainerIdValidator">
        <set name="min" value="0"/>
        <set name="max" value="127"/>
        <set name="node" value="node"/>
        <set name="containerName" value="engineContainer.name"/>
    </bean>

    <bean name="containerBaseportValidator" class="jeus.tool.webadmin.page.J2EEServer.ContainerBaseportValidator">
        <set name="min" value="0"/>
        <set name="node" value="node"/>
        <set name="containerName" value="engineContainer.name"/>        
    </bean>

    <bean name="ejbNameValidator" class="jeus.tool.webadmin.page.JeusServiceEngine.NameValidator">
        <set name="type" value="@jeus.xml.binding.jeusDD.EngineTypeType@EJB"/>
        <set name="node" value="node"/>
    </bean>

    <bean name="ejbNameTranslator" class="jeus.tool.webadmin.translator.DefaultStringTranslator">
		<set name="default" value="beans.ejbNameValidator.generateName()"/>
	</bean>

    <bean name="servletNameValidator" class="jeus.tool.webadmin.page.JeusServiceEngine.NameValidator">
        <set name="type" value="@jeus.xml.binding.jeusDD.EngineTypeType@SERVLET"/>
        <set name="node" value="node"/>
    </bean>

	<bean name="servletNameTranslator" class="jeus.tool.webadmin.translator.DefaultStringTranslator">
		<set name="default" value="beans.servletNameValidator.generateName()"/>
	</bean>
	
    <bean name="jmsNameValidator" class="jeus.tool.webadmin.page.JeusServiceEngine.NameValidator">
        <set name="type" value="@jeus.xml.binding.jeusDD.EngineTypeType@JMS"/>
        <set name="node" value="node"/>
    </bean>
    
	<bean name="jmsNameTranslator" class="jeus.tool.webadmin.translator.DefaultStringTranslator">
		<set name="default" value="beans.jmsNameValidator.generateName()"/>
	</bean>    

    <bean name="wsNameValidator" class="jeus.tool.webadmin.page.JeusServiceEngine.NameValidator">
        <set name="type" value="@jeus.xml.binding.jeusDD.EngineTypeType@WS"/>
        <set name="node" value="node"/>
    </bean>
    
	<bean name="wsNameTranslator" class="jeus.tool.webadmin.translator.DefaultStringTranslator">
		<set name="default" value="beans.wsNameValidator.generateName()"/>
	</bean>    

    <bean name="ejbEngNameValidator" class="jeus.tool.webadmin.page.J2EEServer.EngineNameValidator">
        <set name="type" value="@jeus.xml.binding.jeusDD.EngineTypeType@EJB"/>
        <set name="node" value="node"/>
        <set name="create" value="createEjbEngine"/>
    </bean>
    
	<bean name="ejbEngNameTranslator" class="jeus.tool.webadmin.translator.DefaultStringTranslator">
		<set name="default" value="beans.ejbEngNameValidator.generateName()"/>
	</bean>    

    <bean name="servletEngNameValidator" class="jeus.tool.webadmin.page.J2EEServer.EngineNameValidator">
        <set name="type" value="@jeus.xml.binding.jeusDD.EngineTypeType@SERVLET"/>
        <set name="node" value="node"/>
        <set name="create" value="createServletEngine"/>
    </bean>
    
	<bean name="servletEngNameTranslator" class="jeus.tool.webadmin.translator.DefaultStringTranslator">
		<set name="default" value="beans.servletEngNameValidator.generateName()"/>
	</bean>    

    <bean name="jmsEngNameValidator" class="jeus.tool.webadmin.page.J2EEServer.EngineNameValidator">
        <set name="type" value="@jeus.xml.binding.jeusDD.EngineTypeType@JMS"/>
        <set name="node" value="node"/>
        <set name="create" value="createJmsEngine"/>
    </bean>
    
	<bean name="jmsEngNameTranslator" class="jeus.tool.webadmin.translator.DefaultStringTranslator">
		<set name="default" value="beans.jmsEngNameValidator.generateName()"/>
	</bean>    

    <property name="engineCommand"/>

    <property name="ejbEngName"/>
    <property name="servletEngName"/>
    <property name="jmsEngName"/>
    <property name="wsEngName"/>

    <property name="createEjbEngine" initial-value="false"/>
    <property name="createServletEngine" initial-value="false"/>
    <property name="createJmsEngine" initial-value="false"/>

    <property name="listenerId"/>
    <property name="listenerPort"/>
    <property name="jmsChannelName"/>
    <property name="jmsChannelPort"/>

    <property name="engineType"/>

</page-specification>