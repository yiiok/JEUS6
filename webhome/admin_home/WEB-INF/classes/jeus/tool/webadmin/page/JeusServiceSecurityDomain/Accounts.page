<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE page-specification PUBLIC
  "-//Apache Software Foundation//Tapestry Specification 4.0//EN" 
  "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">

<page-specification class="jeus.tool.webadmin.page.JeusServiceSecurityDomain.AccountsPage">
    
    <component id="mainBorder" type="jeus:MainBorder">
        <binding name="title" value="literal:Security Accounts"/>
        <binding name="helpParameter" value="components.accountsTab.activeTabIndex"/>        
    </component>

    <component id="tabPanel" type="jeus:TabPanel">
        <binding name="pageNames" value="@jeus.tool.webadmin.page.PageNames@JEUSSERVICE_SECURITYDOMAIN_NAMES"/>
    </component>

    <component id="accountsForm" type="jeus:JEUSForm">
        <binding name="title" value="message:domain.accounts.title"/>
        <binding name="useDefaultButtons" value="false"/>
        <binding name="useForm" value="false"/>
    </component>

    <component id="accountsTab" type="jeus:InnerTabPanel">
        <binding name="model" value="new jeus.tool.webadmin.component.GeneralTabModel(new java.lang.String[]{'domain.accounts.memory.label', 'domain.accounts.repository.label'}, new java.lang.String[]{'memory', 'repository'})"/>
    	<!--<binding name="model" value="new jeus.tool.webadmin.component.GeneralTabModel(new java.lang.String[]{'domain.accounts.repository.label'}, new java.lang.String[]{'repository'})"/>
    --></component>

    <component id="memory" type="Block"/>
    <component id="repository" type="Block"/>

    <component id="memoryForm" type="jeus:JEUSForm">
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="accounts" type="jeus:Field">
        <binding name="field" value="component:accountsField"/>
        <binding name="label" value="message:domain.accounts.accounts.label"/>
    </component>

    <component id="accountsField" type="PropertySelection">
        <binding name="model" value="model"/>
        <binding name="value" value="selectedAccount"/>
        <binding name="size" value="10"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="modify" type="Submit">
        <binding name="value" value="message:domain.services.modify.label"/>
        <binding name="listener" value="listener:onModify"/>
    </component>

    <component id="remove" type="Submit">
        <binding name="value" value="message:domain.services.remove.label"/>
        <binding name="message" value="message:JEUSForm.remove.confirm"/>
        <binding name="listener" value="listener:onRemoveOk"/>
    </component>

    <component id="create" type="Submit">
        <binding name="value" value="message:domain.services.create.label"/>
        <binding name="listener" value="listener:onCreate"/>
    </component>

    <component id="repositoryForm" type="jeus:JEUSForm">
        <binding name="useDefaultButtons" value="false"/>
    </component>

    <component id="userTableLabel" type="Insert">
        <binding name="value" value="message:domain.accounts.repository.user_table.label"/>
    </component>

    <component id="groupTableLabel" type="Insert">
        <binding name="value" value="message:domain.accounts.repository.group_table.label"/>
    </component>

    <component id="user_name_column" type="Insert">
        <binding name="value" value="message:domain.accounts.name.label"/>
    </component>

    <component id="user_password_column" type="Insert">
        <binding name="value" value="message:domain.accounts.password.label"/>
    </component>

    <component id="user_group_column" type="Insert">
        <binding name="value" value="message:domain.accounts.group.label"/>
    </component>

    <component id="user_description_column" type="Insert">
        <binding name="value" value="message:domain.accounts.description.label"/>
    </component>

    <component id="eachUser" type="For">
        <binding name="source" value="users"/>
        <binding name="value" value="userView"/>
        <binding name="element" value="literal:tr"/>
    </component>

    <component id="eachUserGroup" type="For">
        <binding name="source" value="userView.group"/>
        <binding name="value" value="userGroupView"/>
        <binding name="element" value="literal:tr"/>
    </component>

    <component id="user_name_value" type="Insert">
        <binding name="value" value="userView.name"/>
    </component>

    <component id="user_password_value" type="Insert">
        <binding name="value" value="userView.password"/>
    </component>

    <component id="user_group_value" type="Insert">
        <binding name="value" value="userGroupView.name"/>
    </component>

    <component id="user_description_value" type="Insert">
        <binding name="value" value="userView.description"/>
    </component>

    <component id="userDeleteLink" type="DirectLink">
        <binding name="listener" value="listener:onUserDeleteOk"/>
        <binding name="parameters" value="userView.name"/>
        <binding name="renderer" value="@jeus.tool.webadmin.component.render.ConfirmLinkRenderer@build('common.message.delete.confirm', userView.name)"/>
    </component>

    <component id="userConfigLink" type="DirectLink">
    	<binding name="listener" value="listener:onChangeUserMode"/>
    	<binding name="parameters" value="{false, userView.name}"/>
    </component>
    
    <component id="delete" type="Image">
        <binding name="image" value="asset:delete"/>
    </component>

    <component id="repositoryConfigUserForm" type="jeus:JEUSForm">
        <binding name="title" value="createMode ? messages.getMessage('domain.accounts.repository.user.create.label') : messages.getMessage('domain.accounts.repository.user.modify.label')"/>
        <binding name="success" value="listener:onRepositoryUserOk"/>
        <binding name="subform" value="true"/>
    </component>

    <component id="user_name" type="jeus:Field">
        <binding name="field" value="component:user_nameField"/>
        
    </component>

    <component id="user_nameField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="user"/>
        <binding name="elementName" value="literal:name"/>
        <binding name="validators" value="validators:required"/>
    </component>

    <component id="user_password" type="jeus:Field">
        <binding name="field" value="component:user_passwordField"/>
    </component>

    <component id="user_algorithmField" type="PropertySelection">
        <binding name="value" value="userPasswordAlgorithm"/>
        <binding name="model" value="@jeus.tool.webadmin.page.EnumerationSet@JEUS_CIPHER_ALGORITHM"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="user_passwordField" type="jeus:JAXBAlgorithmField">
        <binding name="hidden" value="true"/>
        <binding name="parentElement" value="user"/>
        <binding name="elementName" value="literal:password"/>
        <binding name="algorithm" value="userPasswordAlgorithm"/>
    </component>

    <component id="user_group" type="jeus:Field">
        <binding name="field" value="component:user_groupField"/>
        <binding name="label" value="'Group'"/>
    </component>

    <component id="user_groupField" type="jeus:Palette">
        <binding name="model" value="groupModel"/>
        <binding name="selected" value="userGroupSelected"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="user_description" type="jeus:Field">
        <binding name="field" value="component:user_descriptionField"/>
    </component>

    <component id="user_descriptionField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="user"/>
        <binding name="elementName" value="literal:description"/>
    </component>

    <component id="group_name_column" type="Insert">
        <binding name="value" value="message:domain.accounts.name.label"/>
    </component>

    <component id="sub_group_column" type="Insert">
        <binding name="value" value="message:domain.accounts.subgroup.label"/>
    </component>

    <component id="group_description_column" type="Insert">
        <binding name="value" value="message:domain.accounts.description.label"/>
    </component>

    <component id="eachGroup" type="For">
        <binding name="source" value="groups"/>
        <binding name="value" value="groupView"/>
        <binding name="element" value="literal:tr"/>
    </component>

    <component id="eachSubGroup" type="For">
        <binding name="source" value="groupView.subGroup"/>
        <binding name="value" value="subGroupView"/>
        <binding name="element" value="literal:tr"/>
    </component>

    <component id="group_name_value" type="Insert">
        <binding name="value" value="groupView.name"/>
    </component>

    <component id="sub_group_value" type="Insert">
        <binding name="value" value="subGroupView.name"/>
    </component>

    <component id="group_description_value" type="Insert">
        <binding name="value" value="groupView.description"/>
    </component>

    <component id="groupDeleteLink" type="DirectLink">
        <binding name="listener" value="listener:onGroupDeleteOk"/>
        <binding name="parameters" value="groupView.name"/>
        <binding name="renderer" value="@jeus.tool.webadmin.component.render.ConfirmLinkRenderer@build('common.message.delete.confirm', groupView.name)"/>
    </component>

    <component id="delete2" copy-of="delete"/>

    <component id="repositoryConfigGroupForm" type="jeus:JEUSForm">
        <binding name="title" value="createMode ? messages.getMessage('domain.accounts.repository.group.create.label') : messages.getMessage('domain.accounts.repository.group.modify.label')"/>
        <binding name="success" value="listener:onRepositoryGroupOk"/>
        <binding name="subform" value="true"/>
    </component>

    <component id="group_name" type="jeus:Field">
        <binding name="field" value="component:group_nameField"/>
        
    </component>

    <component id="group_nameField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="group"/>
        <binding name="elementName" value="literal:name"/>
        <binding name="validators" value="validators:required"/>
    </component>

    <component id="sub_group" type="jeus:Field">
        <binding name="field" value="component:sub_groupField"/>
        <binding name="label" value="'Sub Group'"/>
    </component>

    <component id="sub_groupField" type="jeus:Palette">
        <binding name="model" value="groupModel"/>
        <binding name="selected" value="subGroupSelected"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="group_description" type="jeus:Field">
        <binding name="field" value="component:group_descriptionField"/>
    </component>

    <component id="group_descriptionField" type="jeus:JAXBTextField">
        <binding name="parentElement" value="group"/>
        <binding name="elementName" value="literal:description"/>
    </component>
    
    <component id="groupConfigLink" type="DirectLink">
    	<binding name="listener" value="listener:onChangeGroupMode"/>
    	<binding name="parameters" value="{false, groupView.name}"/>
    </component>

    <component id="close" type="Submit">
        <binding name="value" value="message:domain.services.close.label"/>
        <binding name="listener" value="listener:onClose"/>
    </component>

    <component id="condModify" type="If">
        <binding name="condition" value="command != null and @jeus.tool.webadmin.page.JeusServiceSecurityDomain.SecurityCommand@MODIFY_COMMAND.equals(command)"/>
    </component>

    <component id="modifyForm" type="jeus:JEUSForm">
        <binding name="title" value="message:domain.accounts.modify.title"/>
        <binding name="subform" value="true"/>
        <binding name="success" value="listener:onModifyOk"/>
    </component>

    <component id="hiddenAccount" type="Hidden">
        <binding name="value" value="selectedAccount"/>
    </component>

    <component id="modify_name" type="jeus:ReadOnlyTextField">
        <binding name="label" value="message:domain.accounts.name.label"/>
        <binding name="value" value="selectedAccount"/>
    </component>

    <component id="modify_algorithm" type="jeus:Field">
        <binding name="field" value="component:modify_algorithmField"/>
        <binding name="label" value="message:domain.accounts.password.algorithm.label"/>
        
    </component>

    <component id="modify_algorithmField" type="PropertySelection">
        <binding name="value" value="modifyPasswordAlgorithm"/>
        <binding name="model" value="@jeus.tool.webadmin.page.EnumerationSet@JEUS_CIPHER_ALGORITHM"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="modify_password" type="jeus:Field">
        <binding name="field" value="component:modify_passwordField"/>
        
    </component>

    <component id="modify_passwordField" type="TextField">
        <binding name="value" value="password"/>
        <binding name="hidden" value="true"/>
        <binding name="displayName" value="message:domain.accounts.password.label"/>
        <binding name="validators" value="validators:required"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="modify_confirm_password" type="jeus:Field">
        <binding name="field" value="component:confirm_passwordField"/>
        
    </component>

    <component id="modify_confirm_passwordField" type="TextField">
        <binding name="value" value="confirmPassword"/>
        <binding name="hidden" value="true"/>
        <binding name="displayName" value="message:domain.accounts.confirm_password.label"/>
        <binding name="validators" value="validators:required"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="condCreate" type="If">
        <binding name="condition" value="command != null and @jeus.tool.webadmin.page.JeusServiceSecurityDomain.SecurityCommand@CREATE_COMMAND.equals(command)"/>
    </component>

    <component id="createForm" type="jeus:JEUSForm">
        <binding name="title" value="message:domain.accounts.create.title"/>
        <binding name="subform" value="true"/>
        <binding name="success" value="listener:onCreateOk"/>
    </component>

    <component id="name" type="jeus:Field">
        <binding name="field" value="component:nameField"/>
        
    </component>

    <component id="nameField" type="TextField">
        <binding name="value" value="name"/>
        <binding name="displayName" value="message:domain.accounts.name.label"/>
        <binding name="validators" value="validators:required"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="algorithm" type="jeus:Field">
        <binding name="field" value="component:algorithmField"/>
        <binding name="label" value="message:domain.accounts.password.algorithm.label"/>
        
    </component>

    <component id="algorithmField" type="PropertySelection">
        <binding name="value" value="passwordAlgorithm"/>
        <binding name="model" value="@jeus.tool.webadmin.page.EnumerationSet@JEUS_CIPHER_ALGORITHM"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="password" type="jeus:Field">
        <binding name="field" value="component:passwordField"/>
        
    </component>

    <component id="passwordField" type="TextField">
        <binding name="value" value="password"/>
        <binding name="hidden" value="true"/>
        <binding name="displayName" value="message:domain.accounts.password.label"/>
        <binding name="validators" value="validators:required"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>

    <component id="confirm_password" type="jeus:Field">
        <binding name="field" value="component:confirm_passwordField"/>
        
    </component>

    <component id="confirm_passwordField" type="TextField">
        <binding name="value" value="confirmPassword"/>
        <binding name="hidden" value="true"/>
        <binding name="displayName" value="message:domain.accounts.confirm_password.label"/>
        <binding name="validators" value="validators:required"/>
        <binding name="disabled" value="!@jeus.tool.webadmin.hivemind.Lock@isEnabledEdit(getSettings(), getVisit())"/>
    </component>
    
    <component id="createUserLink" type="DirectLink">
    	<binding name="listener" value="listener:onChangeUserMode"/>
    	<binding name="parameters" value="{true, null}"/>
    </component>
    
    <component id="create_user_label" type="Insert">
    	<binding name="value" value="message:domain.accounts.repository.user_create.label"/>
    </component>
    
    <component id="createGroupLink" type="DirectLink">
    	<binding name="listener" value="listener:onChangeGroupMode"/>
    	<binding name="parameters" value="{true, null}"/>
    </component>
    
    <component id="create_group_label" type="Insert">
    	<binding name="value" value="message:domain.accounts.repository.group_create.label"/>
    </component>    

    <asset name="delete" path="context:/image/table/delete.gif"/>

    <property name="userView"/>
    <property name="userGroupView"/>
    <property name="groupView"/>
    <property name="subGroupView"/>

</page-specification>