/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["tapestry.core"]){dojo._hasResource["tapestry.core"]=true;var tapestry={isIE:dojo.isIE,log:function(){},addOnLoad:function(){dojo.addOnLoad.apply(this,arguments);},byId:dojo.byId,provide:dojo.provide,connect:function(_1,_2,_3){_1=dojo.byId(_1);tapestry["h_"+_3]=dojo.connect(_1,_2,tapestry,_3);},connectBefore:function(_4,_5,_6){_4=dojo.byId(_4);var _7=_4[_5];_4[_5]=function(){tapestry[_6].apply(this,arguments);_7.apply(this,arguments);};},cleanConnect:function(_8,_9,_a){dojo.disconnect(tapestry["h_"+_a]);},bind:function(_b,_c,_d){tapestry.log("t.bind",arguments);var _e={url:_b,content:_c,useCache:true,preventCache:true,encoding:tapestry.requestEncoding,error:(function(){tapestry.error.apply(this,arguments);})};if(typeof _d!="undefined"&&_d){_e.handleAs="json";_e.headers={"json":true};_e.load=(function(){tapestry.loadJson.apply(this,arguments);});}else{_e.handleAs="xml";_e.headers={"dojo-ajax-request":true};_e.load=(function(){tapestry.load.apply(this,arguments);});}dojo.xhrGet(_e);},error:function(){tapestry.log("error");},load:function(_f,_10){if(!_f){tapestry.log("No data received in response.");return;}var _11=_f.getElementsByTagName("ajax-response");if(!_11||_11.length<1||!_11[0].childNodes){tapestry.log("No ajax-response elements received.");return;}var _12=_11[0].childNodes;var _13=[];var _14=[];var _15=[];for(var i=0;i<_12.length;i++){var _16=_12[i].getAttribute("type");var id=_12[i].getAttribute("id");if(_16=="exception"){dojo.log.err("Remote server exception received.");tapestry.presentException(_12[i],kwArgs);return;}else{if(_16=="page"){window.location=_12[i].getAttribute("url");return;}else{if(_16=="status"){dojo.publish(id,{message:tapestry.html.getContentAsString(_12[i])});continue;}}}if(_16=="script"){if(id=="initializationscript"){_14.push(_12[i]);continue;}else{if(id=="bodyscript"){_13.push(_12[i]);continue;}else{if(id=="includescript"){var _17=_12[i].getElementsByTagName("include");if(!_17){continue;}for(var e=0;e<_17.length;e++){tapestry.loadScriptFromUrl(_17[e].getAttribute("url"));}continue;}}}}else{_15.push(_12[i]);}if(!id){tapestry.log("No element id found in ajax-response node.");continue;}var _18=dojo.byId(id);if(!_18){tapestry.log("No node could be found to update content in with id "+id);continue;}tapestry.loadContent(id,_18,_12[i]);}for(var i=0;i<_13.length;i++){tapestry.loadScriptContent(_13[i],true);}for(var i=0;i<_15.length;i++){tapestry.loadScriptContent(_15[i],true);}for(var i=0;i<_14.length;i++){tapestry.loadScriptContent(_14[i],true);}},loadJson:function(){tapestry.log("loadJson");},loadContent:function(id,_19,_1a){if(typeof _1a.childNodes!="undefined"&&_1a.childNodes.length>0){for(var i=0;i<_1a.childNodes.length;i++){if(_1a.childNodes[i].nodeType!=1){continue;}var _1b=_1a.childNodes[i].getAttribute("id");if(_1b){_1a=_1a.childNodes[i];break;}}}tapestry.log("dojo.event.browser.clean replacement???");var _1c=tapestry.html.getContentAsString(_1a);if(tapestry.isIE&&_19.outerHTML&&_19.nodeName=="SELECT"){_19.outerHTML=_19.outerHTML.replace(/(<SELECT[^<]*>).*(<\/SELECT>)/,"$1"+_1c+"$2");_19=tapestry.byId(id);}else{if(_1c&&_1c.length>0){_19.innerHTML=_1c;}}var _1d=_1a.attributes;var _1e,i=0;while((_1e=_1d[i++])){if(tapestry.isIE){if(!_1e){continue;}if((typeof _1e=="object")&&(typeof _1e.nodeValue=="undefined")||(_1e.nodeValue==null)||(_1e.nodeValue=="")){continue;}}var nn=_1e.nodeName;var nv=_1e.nodeValue;if(nn=="id"||nn=="type"||nn=="name"){continue;}if(nn=="class"){dojo.addClass(_19,nv);}else{if(nn=="value"){_19.value=nv;}else{_19.setAttribute(nn,nv);}}}var _1f=_1a.getAttribute("disabled");if(!_1f&&_19["disabled"]){_19.disabled=false;}else{if(_1f){_19.disabled=true;}}},loadScriptContent:function(_20,_21){tapestry.log("loadScriptContent",arguments);var _22=tapestry.html.getContentAsString(_20);tapestry.log(_22);},loadScriptFromUrl:function(){tapestry.log("loadScriptFromUrl",arguments);},linkOnClick:function(url,id,_23,_24){var _25={beventname:(_24||"onClick")};_25["beventtarget.id"]=id;tapestry.bind(url,_25,_23);return false;}};tapestry.form={forms:{},currentFocus:null,submit:function(_26,_27,_28){_26=dojo.byId(_26);if(!_26){tapestry.log("Form not found with id "+_26);return;}var id=_26.getAttribute("id");if(_27){_26.submitname.value=_27;}if(dojo.exists("value",_26.submitmode)&&(_26.submitmode.value=="cancel"||_26.submitmode.value=="refresh")&&!_28){_26.submit();return;}if(!tapestry.form.validation.validateForm(_26,this.forms[id])){return;}if(_28&&dojo.exists("async",_28)&&_28.async){tapestry.form.submitAsync(_26,null,_27,_28);return;}else{if(dojo.exists(id,this.forms)&&this.forms[id].async){tapestry.form.submitAsync(_26);return;}}_26.submit();},cancel:function(_29,_2a,_2b){tapestry.log("t.f.submit",arguments);},refresh:function(_2c,_2d,_2e){tapestry.log("t.f.submit",arguments);},registerForm:function(id,_2f,_30){return;var _31=dojo.byId(id);if(!_31){dojo.raise("Form not found with id "+id);return;}id=_31.getAttribute("id");if(this.forms[id]){for(var i=0;i<_31.elements.length;i++){var _32=_31.elements[i];if(_32&&_32.type&&(_32.type.toLowerCase()=="submit"||_32.type.toLowerCase()=="button")){}}var _33=_31.getElementsByTagName("input");for(var i=0;i<_33.length;i++){var _34=_33[i];if(_34.type.toLowerCase()=="image"&&_34.form==_31){}}delete this.forms[id];}this.forms[id]={};this.forms[id].validateForm=true;this.forms[id].profiles=[];this.forms[id].async=(typeof _2f!="undefined")?_2f:false;this.forms[id].json=(typeof _30!="undefined")?_30:false;if(!this.forms[id].async){dojo.connect(_31,"onsubmit",this,"onFormSubmit");}else{for(var i=0;i<_31.elements.length;i++){var _32=_31.elements[i];if(_32&&_32.type&&(_32.type.toLowerCase()=="submit"||_32.type.toLowerCase()=="button")){dojo.connect(_32,"onclick",tapestry.form,"inputClicked");}}var _33=_31.getElementsByTagName("input");for(var i=0;i<_33.length;i++){var _34=_33[i];if(_34.type.toLowerCase()=="image"&&_34.form==_31){dojo.connect(_34,"onclick",tapestry.form,"inputClicked");}}dojo.connect(_31,"onsubmit",this,"overrideSubmit");}},overrideSubmit:function(e){dojo.stopEvent(e);var elm=e.target;if(dojo.exists("form",elm)){elm=elm.form;}tapestry.form.submitAsync(elm);},inputClicked:function(e){var _35=e.currentTarget;if(_35.disabled||!dojo.exists("form",_35)){return;}this.forms[_35.form.getAttribute("id")].clickedButton=_35;},onFormSubmit:function(evt){if(!evt||!dojo.exists("target",evt)){tapestry.log("No valid form event found with argument: "+evt);return;}var id=evt.target.getAttribute("id");if(!id){tapestry.log("Form had no id attribute.");return;}var _36=dojo.byId(id);if(dojo.exists("value",_36.submitmode)&&(_36.submitmode.value=="cancel"||_36.submitmode.value=="refresh")){return;}if(!tapestry.form.validation.validateForm(_36,this.forms[id])){dojo.stopEvent(evt);}},submitAsync:function(_37,_38,_39,_3a){_37=dojo.byId(_37);if(!_37){tapestry.log("Form not found with id "+id);return;}var _3b=_37.getAttribute("id");if(!tapestry.form.validation.validateForm(_37,this.forms[_3b])){tapestry.log("Form validation failed for form with id "+_3b);return;}if(_39){var _3c=_37.submitname.value;_37.submitname.value=_39;if(!_38){_38={};}if(_37[_39]){_38[_39]=_37[_39].value;}}if(dojo.exists("clickedButton",this.forms[_3b])){if(!_38){_38={};}_38[this.forms[_3b].clickedButton.getAttribute("name")]=this.forms[_3b].clickedButton.getAttribute("value");delete this.forms[_3b].clickedButton;}var _3d={form:_37,content:_38,useCache:true,preventCache:true,error:(function(){tapestry.error.apply(this,arguments);}),encoding:tapestry.requestEncoding};if(_3a){if(dojo.exists("url",_3a)){_3d.url=_3a.url;}}if(this.forms[_3b].json||_3a&&_3a.json){_3d.headers={"json":true};_3d.handleAs="json";_3d.load=(function(){tapestry.loadJson.apply(this,arguments);});}else{_3d.headers={"dojo-ajax-request":true};_3d.handleAs="xml";_3d.load=(function(){tapestry.load.apply(this,arguments);});}dojo.xhrPost(_3d);if(_39){_37.submitname.value=_3c;}},registerProfile:function(id,_3e){if(!this.forms[id]){return;}this.forms[id].profiles.push(_3e);},clearProfiles:function(id){if(!this.forms[id]){return;}for(var i=0;i<this.forms[id].profiles.length;i++){delete this.forms[id].profiles[i];}this.forms[id].profiles=[];},focusField:function(_3f){tapestry.log("t.f.focusField",arguments);try{_3f=dojo.byId(_3f);if(_3f.disabled||_3f.clientWidth<1){return;}if(dojo.exists("focus",_3f)){_3f.focus();return;}}catch(e){}},datetime:{isValidDate:function(_40){tapestry.log("t.f.d.isValidDate",arguments);return true;}},validation:{isReal:function(){tapestry.log("t.f.v.isReal",arguments);return true;},greaterThanOrEqual:function(){tapestry.log("t.f.v.greaterThanOrEqual",arguments);return true;},lessThanOrEqual:function(){tapestry.log("t.f.v.lessThanOrEqual",arguments);return true;},isText:function(){tapestry.log("t.f.v.isText",arguments);return true;},isEmailAddress:function(){tapestry.log("t.f.v.isEmailAddress",arguments);return true;},isValidPattern:function(){tapestry.log("t.f.v.isValidPattern",arguments);return true;},validateForm:function(){tapestry.log("t.f.v.validateForm",arguments);return true;}}};tapestry.event={stopEvent:dojo.stopEvent};tapestry.widget={synchronizeWidgetState:function(){tapestry.log("t.w.synchronizeWidgetState",arguments);}};tapestry.html={CompactElementRegexp:/<([a-zA-Z](?!nput)[a-zA-Z]*)([^>]*?)\/>/g,CompactElementReplacer:"<$1$2></$1>",getContentAsString:function(_41){if(typeof _41.xml!="undefined"){return this._getContentAsStringIE(_41);}else{if(typeof XMLSerializer!="undefined"){return this._getContentAsStringMozilla(_41);}else{return this._getContentAsStringGeneric(_41);}}},getElementAsString:function(_42){if(!_42){return "";}var s="<"+_42.nodeName;if(_42.attributes&&_42.attributes.length>0){for(var i=0;i<_42.attributes.length;i++){s+=" "+_42.attributes[i].name+"=\""+_42.attributes[i].value+"\"";}}s+=">";s+=this._getContentAsStringGeneric(_42);s+="</"+_42.nodeName+">";return s;},enhanceExceptionPage:function(){var _43=dojo.query(".toggle");if(_43&&_43.length>0){for(var i=0;i<_43.length;i++){dojo.connect(_43[i],"onclick",function(e){var _44=e.target;dojo.toggleClass(_44,"toggleSelected");if(e.preventDefault){tapestry.event.stopEvent(e);}return false;});}}_43=dojo.query(".exception-link");if(_43&&_43.length>0){_43[_43.length-1].onclick({target:_43[_43.length-1]});}},_getContentAsStringIE:function(_45){var s=" ";for(var i=0;i<_45.childNodes.length;i++){s+=_45.childNodes[i].xml;}return s;},_getContentAsStringMozilla:function(_46){if(!this.xmlSerializer){this.xmlSerializer=new XMLSerializer();}var s="";for(var i=0;i<_46.childNodes.length;i++){s+=this.xmlSerializer.serializeToString(_46.childNodes[i]);if(s=="undefined"){return this._getContentAsStringGeneric(_46);}}return this._processCompactElements(s);},_getContentAsStringGeneric:function(_47){var s="";if(_47==null){return s;}for(var i=0;i<_47.childNodes.length;i++){switch(_47.childNodes[i].nodeType){case 1:case 5:s+=this.getElementAsString(_47.childNodes[i]);break;case 3:case 2:case 4:s+=_47.childNodes[i].nodeValue;break;default:break;}}return s;},_processCompactElements:function(_48){return _48.replace(this.CompactElementRegexp,this.CompactElementReplacer);}};dojo.provide("tapestry.core");dojo.provide("tapestry.html");dojo.provide("tapestry.event");dojo.provide("tapestry.lang");dojo.provide("tapestry.form");dojo.provide("tapestry.form.datetime");}