<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns="" http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>JDBC 데이터 소스</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="WebAdmin 온라인 도움말"/><link rel="up" href="index.html" title="WebAdmin 온라인 도움말"/><link rel="prev" href="JTAResource.html" title="트랜잭션"/><link rel="next" href="URLResource.html" title="URL 리소스"/></head><body><div class="section" lang="ko"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="JeusServiceJDBCDataSourceService"/>JDBC 데이터 소스</h2></div></div></div>
  

  

  <p><span class="bold"><strong>네비게이션 경로</strong></span>: Home &gt;
  <em class="replaceable"><code>node-name</code></em> &gt; JEUS 매니저 리소스 &gt; JDBC</p>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="JeusServiceJDBCDataSourceService_Overview"/>개요</h3></div></div></div>
    

    <p>이 화면에서는 현재 노드에 생성된 데이터 소스 정보를 보여준다. 각각의 데이터 소스 정보는 다음의 항목으로 구성되어
    있다.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><span class="bold"><strong>데이터 소스 ID</strong></span></p>

        <p>데이터 소스를 구별하는 ID. 새 JDBC 데이터 소스 생성시 데이터 소스 ID를 입력하지 않았을 경우에는 익스포트
        이름이 데이터 소스 ID가 된다.</p>
      </li><li>
        <p><span class="bold"><strong>벤더</strong></span></p>

        <p>드라이버의 벤더 이름</p>
      </li><li>
        <p><span class="bold"><strong>클래스 이름</strong></span></p>

        <p>드라이버의 데이터 소스 클래스 이름</p>
      </li><li>
        <p><span class="bold"><strong>데이터 소스 종류</strong></span></p>

        <p>DataSource, ConnectionPoolDataSource, LocalXADataSource,
        XADataSource</p>
      </li><li>
        <p><span class="bold"><strong>명령</strong></span></p>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>바인드</p>

            <p>데이터 소스의 익스포트 이름으로 JNDI에 등록한다.</p>
          </li><li>
            <p>테스트</p>

            <p>JDBC 드라이버 설정이 올바르게 되었는지 테스트하는 명령이다.</p>
          </li><li>
            <p>생성</p>

            <p>데이터 소스의 커넥션 풀을 생성한다. 보통 어플리케이션에서 커넥션을 요청했을 때 커넥션 풀을 생성하지만 이
            명령을 통해서 관리자가 미리 커넥션 풀을 생성할 수 있다.</p>
          </li><li>
            <p>재구성</p>

            <p>데이터 소스의 커넥션 풀에 존재하는 커넥션을 새로운 커넥션으로 교체한다. 기존 커넥션에 문제가 생겨 사용할
            수 없을 경우 새로운 커넥션으로 커넥션 풀을 재구성할 수 있다. 어플리케이션에서 사용중인 기존 커넥션은 커넥션 풀에
            반납될 때 교체된다.</p>
          </li></ul></div>
      </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="JeusServiceJDBCDataSourceService_Create"/>새 JDBC 데이터 소스 생성</h3></div></div></div>
    

    <p>화면의 <span class="emphasis"><em>'새 JDBC 데이터 소스 생성'</em></span>을 클릭하여 데이터 소스를 생성한다. 이를
    클릭하면 다음의 순서대로 화면이 넘어간다.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><span class="bold"><strong>데이터 소스</strong></span></p>

        <p>이 화면에서는 데이터 소스 벤더와 데이터 소스 유형을 결정한다. 자신이 현재 사용하고 있는 데이터베이스를 참고하여
        설정한다.</p>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>DBMS : 데이터 소스 벤더</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>가능한 데이터 소스들 : 데이터 소스 벤더에서 제공하는 데이터 소스 유형</p>
          </li></ul></div>
      </li><li>
        <p><span class="bold"><strong>속성</strong></span></p>

        <p>이 화면에서는 데이터 소스의 속성을 결정한다.</p>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>vendorField : 데이터 소스 벤더</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>data_source_class_nameField : 데이터 소스 벤더에서 제공하는 데이터 소스 구현 클래스
            이름</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>data_source_typeField : 'DataSource',
            'ConnectionPoolDataSource', 'XADataSource', 'LocalXADataSource' 중
            하나</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>data_source_idField : 노드에서 관리하는 데이터 소스 ID. 설정되지 않으면
            'export_nameField'의 설정이 이것을 대신한다.</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>export_nameField : JNDI에 등록되는 이름</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>data_source_targetField : 데이터 소스를 사용할 수 있는 엔진 컨테이너 이름. 설정하지
            않으면 노드에 속한 모든 엔진 컨테이너에서 사용할 수 있게 된다.</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>database_nameField : DB 이름. oracle의 경우 SID</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>port_numberField : DB 리스터 포트 번호</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>server_nameField : DB가 운용중인 서버의 DNS 이름이나 IP주소</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>userField : 사용자 이름</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>passwordField : 사용자 패스워드. 사용자 패스워드를 암호화해서 사용할 경우 암호화 알고리즘
            선택이 가능하다.</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>login_timeoutField : 데이터 소스가 DB와 연결을 맺기 위해 기다릴 수 있는 sec. 단위
            한계 시간</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>additional_propertiesField : 각 벤더의 데이터 소스에서 지원하는 커스텀 기능에 대한
            프로퍼티</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>descriptionField : 데이터 소스에 대한 설명</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>autoCommitField : 커넥션의 auto commit 값. 설정되지 않은 경우 벤더의 디폴트
            auto commit 값이 유효하며 XADataSource와 LocalXADataSource는 커넥션이 트랜잭션에
            연동되어 있지 않은 경우에만 적용된다.</p>
          </li></ul></div>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>stmtQueryTimeoutField : DB로의 오퍼레이션 수행 후 드라이버가 응답을 기다릴 수 있는
            sec. 단위 한계 시간</p>
          </li><li>
            <p>close_policy_on_leakField : 어플리케이션에서 사용하고 반납하지 않은 커넥션에 대한
            로깅이나 반환 정책. 설정하지 않은 경우 엔진 컨테이서의 설정을 따른다. 다음의 세 가지 중 하나를 선택할 수
            있다.</p>

            <div class="itemizedlist"><ul type="square"><li>
                <p>NoAction : 반납하지 않은 커넥션에 대한 로깅이나 반환을 전혀 하지 않는다.</p>
              </li><li>
                <p>Warning : 반납하지 않은 커넥션에 대한 로깅만 한다.</p>
              </li><li>
                <p>AutoClose : 반납하지 않은 커넥션에 대한 로깅과 반환을 모두 한다.</p>
              </li></ul></div>
          </li></ul></div>
      </li><li>
        <p><span class="bold"><strong>커넥션 풀</strong></span></p>

        <p>이 화면에서는 커넥션 풀의 속성을 결정한다.</p>

        <div class="itemizedlist"><ul type="circle"><li>
            <p>minField : 커넥션 풀에서 관리할 커넥션의 최소 개수</p>
          </li><li>
            <p>maxField : 커넥션 풀에서 관리할 커넥션의 최대 개수</p>
          </li><li>
            <p>stepField : 커넥션 풀의 사이즈 증가 폭</p>
          </li><li>
            <p>periodField : 컨넥션 풀의 사이즈 조정 주기. 단위는 msec.</p>
          </li><li>
            <p>enable_waitField : 커넥션 풀의 사이즈가 'maxField'에 달하고 모든 컨넥션이
            어플리케이션에 의해 사용되는 상황에서 커넥션을 얻기 위해 기다릴지의 여부. 설정하지 않으면 기다림 없이 바로 새로운
            커넥션을 얻을 수 있으나 그 커넥션은 사용 후 풀링되지 않고 바로 커넥션 풀에서 제거된다. 이러한 커넥션을
            'disposable 커넥션'이라고 부르는데 어플리케이션의 커넥션 요청이 많은 상황에서는 disposable 커넥션이
            그 요청만큼 늘어나 큰 부하가 될 수 있으므로 주의해야 한다.</p>
          </li><li>
            <p>wait_timeField : 커넥션 풀의 사이즈가 'maxField'에 달하고 모든 컨넥션이 어플리케이션에
            의해 사용되는 상황에서 커넥션을 얻기 위해 기다릴 수 있는 한계 시간. 단위는 msec.이며
            'enabel_waitField'가 설정되었을 때만 유효하다.</p>
          </li><li>
            <p>check_queryField : 커넥션이 사용하는 데 문제가 없는지 확인하기 위해 수행되는 임의의 쿼리문.
            문제가 있는 것으로 확인된 커넥션은 새로운 커넥션으로 교체된다. 클러스터 데이터 소스를 사용하는 경우 개별 데이터
            소스의 상태 확인에 사용되므로 반드시 설정해야 한다.</p>
          </li><li>
            <p>check_query_timeoutField : check-query 수행 후 드라이버가 응답을 기다릴 수
            있는 msec. 단위 한계 시간. 이 시간을 초과한 경우 커넥션에 문제가 있는 것으로 간주되어 새로운 컨넥션으로
            교체된다.</p>
          </li><li>
            <p>non_validation_intervalField : 가장 최근의 check-query와의 시간 차가 이
            인터벌 안에 있으면 check-query를 수행하지 않는다. 커넥션 요청이 빈번할 때 필요 이상으로 잦은
            check-query를 줄일 수 있는 방법으로 단위는 msec.</p>
          </li><li>
            <p>check_query_periodField : 문제가 있는 커넥션을 교체하기 위해 백그라운드에서 동작하는
            쓰레드의 msec. 단위 수행 주기. 'check_queryField'가 설정되어야 유효하며 클러스터 데이터 소스를
            사용하는 경우 개별 데이터 소스의 상태 확인에 사용되므로 반드시 설정해야 한다.</p>
          </li><li>
            <p>check_query_retrial_countField : check-query 실패 한계 횟수</p>
          </li><li>
            <p>check_query_classField :
            jeus.jdbc.connectionpool.JEUSConnectionChecker를 구현한 클래스의 fully
            qualified name. 해당 클래스를 이용하여 check-queyr가 수행되므로 check-query 기능 확장이
            가능하다.</p>
          </li><li>
            <p>destroy_policy_on_check_queryField : check-query가 실패하여 커넥션이
            문제가 있다고 판단될 경우 커넥션 풀에 있는 나머지 커넥션들에 대한 처리 정책.
            'FailedConnectionOnly'는 check-query가 실패한 커넥션만 커넥션 풀에서 제거하고
            'AllConnections'는 커넥션 풀의 모든 커넥션을 제거한다.</p>
          </li><li>
            <p>connection_trace_enabledField : 커넥션이 보여줄 수 있는 정보 구성
            여부</p>
          </li><li>
            <p>connection_trace_get_connection_traceField : 커넥션을 요청한 때 해당
            thread의 stack trace를 확인할 수 있는 기능을 제공한다.</p>
          </li><li>
            <p>connection_trace_auto_commit_traceField : 커넥션에 대하여
            'setAutoCommit' method가 호출되었을 때의 로그와 stack trace를 서버 로그에 기록하는 기능을
            제공한다. 'jeus.jdbc.connection-trace' 로거의 로그 레벨을 FINE으로 설정해야
            한다.</p>
          </li><li>
            <p>useSqlTraceField : 커넥션을 통해 수행되고 있는 SQL문을 서버 로그에 기록하는 기능을
            제공한다. 'jeus.jdbc.sql' 로거의 로거 레벨을 FINE으로 설정해야 한다. 이 기능을 사용할 경우 JDBC
            드라이버의 Statement 객체를 JEUS의 wrapper로 감싸게되므로 JDBC 드라이버의 본래 Statement
            객체로 캐스팅해서 사용하는 어플리케이션은 이 기능을 사용할 수 없다.</p>
          </li><li>
            <p>delegation_datasourceField : XADataSource 또는
            LocalXADataSource를 사용할 때 트랜잭션에 묶이지 않는 상황에서 커넥션을 얻어올 경우 이것에 설정된
            ConnectionPoolDataSource에서 커넥션을 가져온다.</p>
          </li><li>
            <p>keepConnectionHandleOpenField : 커넥션을 풀링하는 동안 커넥션 핸들을 항상
            열어두도록 강제하는 기능을 제공한다.</p>
          </li><li>
            <p>initSqlField : 커넥션을 만들고 난 뒤 가장 처음으로 수행하고자 하는 SQL이 있을 경우
            설정</p>
          </li><li>
            <p>max_use_countField : 커넥션의 사용 회수 한계. 이 사용 회수 이상이 되면 새로운 커넥션으로
            교체한다.</p>
          </li><li>
            <p>stmt_caching_sizeField : PreparedStatement 객체에 대한 캐싱 사이즈.
            Oracle 9i 이후 버전에서는 사용하지 않도록 한다. 다른 DBMS에서는 시스템 리소스의 낭비를 줄임으로써 성능
            향상을 가져 올 수 있다.</p>
          </li><li>
            <p>stmt_fetch_sizeField : Statement의 row fetch 값</p>
          </li><li>
            <p>delegation_dbaField : DBA 권한을 갖는 특별한 데이터 소스 지정. 이 기능은 DB 벤더에
            따라 지원 여부가 다르므로 각 벤더의 매뉴얼 등을 참고하도록 한다.</p>
          </li><li>
            <p>dba_timeoutFiled : 커넥션을 여기에서 지정한 시간이 지난 후에도 반납하지 않으면
            'delegation-dbaField에 설정된 데이터 소스를 통해 해당 커넥션의 DB 세션을 강제로 닫아준다. 하지만
            이 기능은 꽤 위험하고 'stmtQueryTimeoutField' 설정으로 대체할 수 있으므로 사용하기를 권장하지
            않는다. 단위는 msec.</p>
          </li></ul></div>
      </li><li>
        <p><span class="bold"><strong>생성</strong></span></p>

        <p>생성 버튼을 클릭하여 데이터 소스를 생성한다.</p>
      </li></ul></div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="JeusServiceJDBCDataSourceService_Configuration_properties"/>JDBC 데이터 소스 서비스 - 기본 설정</h3></div></div></div>
    

    <p>처음 화면에서 해당 데이터 소스 ID를 클릭하면 데이터 소스의 기본 설정을 볼 수 있다. 이 페이지에서는 처음 데이터
    소스를 생성할 때 지정했던 값들을 출력해주며 설정을 변경할 수 있다. 설정을 변경한 후에는 확인 버튼을 눌러 변경 내용을 반영하도록
    한다. 각 설정에 대한 설명은 위의 '새 JDBC 데이터 소스 생성'을 참조하기 바란다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h4 class="title"><a id="d4e2590"/>JDBC 드라이버의 속성 설정</h4></div></div></div>
      

      <p>데이터베이스의 IP 주소, 포트 번호, 사용자 이름, 패스워드 정보들은 편의상 JEUS에서 필드 입력을 제공하고 있지만
      실제로는 JDBC 드라이버가 필요로 하는 속성이기 때문에 필드로 제공하는 것이 맞지 않다. 특히
      <span class="emphasis"><em>description</em></span> 속성 외에는 JDBC 표준에서 속성 이름을 표준화하지 않았기 때문에
      JDBC 드라이버 별로 속성의 의미가 같더라도 이름이 다를 수 있다. 예를 들어, 오라클 드라이버에서 사용하는
      <span class="emphasis"><em>databaseName</em></span>의 경우 대부분의 JDBC 드라이버가 해당 속성을 사용하고는 있지만
      특정 드라이버에서는 databaseId로 사용할 수도 있다. <span class="emphasis"><em>serverName, portNumber,
      user, password</em></span> 속성 모두 마찬가지다. 따라서 되도록이면 <span class="bold"><strong>Property 입력창</strong></span>을 사용하는 것이 바람직하다.</p>

      <p>Property 입력창에는 다음과 같이 적을 수 있다. <span class="bold"><strong>이름:타입=값</strong></span>의 형식이다. 그리고 여러 Property를 넣을 때는 Property를 새
      줄에 쓰면 된다.</p>

      <pre class="programlisting">   databaseName:java.lang.String=oratest
   portNumber:java.lang.Integer=1521
   serverName:java.lang.String=192.168.100.100
   user:java.lang.String=scott
   password:java.lang.String=tiger
   driverType:java.lang.String=thin</pre>

      <p>이것은 오라클 설정의 경우를 예로 든 것이며, DB2의 경우에는 driverType 속성이
      java.lang.Integer 임에 유의한다. <span class="bold"><strong>이러한 속성 정보들은 각 벤더마다 다르기
      때문에 그 벤더가 제공하는 드라이버 문서를 확인해서 설정해야 한다</strong></span>.</p>

      <p>참고로 속성의 타입이 java.lang.String인 경우에는 <span class="bold"><strong>이름=값</strong></span>으로 적어도 된다. WebAdmin이 기본적으로 String 타입으로 인식하기
      때문이다.</p>
    </div>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h4 class="title"><a id="d4e2605"/>동적 설정 변경</h4></div></div></div>
      

      <p>데이터 소스 설정에서는 아래와 같은 속성들을 동적으로 변경할 수 있다. 동적 변경의 의미는 JEUS를 재시작하지
      않더라도 변경된 속성이 적용된다는 것이다.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Auto Comm</p>
        </li><li>
          <p>Stmt Query Timeout</p>
        </li><li>
          <p>Action On Connection Leak</p>
        </li></ul></div>

      <p>그러나 데이터베이스의 IP 주소, 포트 번호, 사용자 이름, 패스워드와 같은 정보들은 JEUS 커넥션 풀의 속성이
      아니라 JDBC 드라이버가 관리하는 속성들이기 때문에 현재 동적 설정 변경을 지원하지 않는다.</p>

      <p>또한 Export Name, Vendor, 데이터 소스 클래스 이름, 데이터 소스 타입은 JEUS 커넥션 풀에서
      사용하는 값이지만 현재 동적 변경은 되지 않는다.</p>

      <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">경고</h3>
        <p>Auto Commit을 동적으로 변경할 경우 JDBC 드라이버의 로컬 트랜잭션 처리가 달라지므로 주의하기 바란다.
        특히 Auto Commit 값을 false로 변경했을 경우에는 어플리케이션이 java.sql.Connection의
        commit()이나 rollback()을 명시적으로 불러줘야 한다는 점을 유의하기 바란다.</p>
      </div>
    </div>
  </div>

  <div class="section" lang="ko"><div class="titlepage"><div><div><h3 class="title"><a id="JeusServiceJDBCDataSourceService_Configuration_pool"/>JDBC 데이터 소스 서비스 - 커넥션 풀</h3></div></div></div>
    

    <p>이 화면에서는 데이터 소스의 커넥션 풀 속성들을 지정한다. 역시 기본 설정 페이지와 마찬가지로 설정을 변경 할 수 있으며,
    확인 버튼으로 반영하도록 한다. 변경이 실패했을 경우에는 서버 로그를 확인하면 된다. 각 설정에 대한 설명은 위의 '새 JDBC
    데이터 소스 생성'을 참조하기 바란다.</p>

    <div class="section" lang="ko"><div class="titlepage"><div><div><h4 class="title"><a id="d4e2622"/>동적 설정 변경</h4></div></div></div>
      

      <p>커넥션 풀 설정에서는 아래와 같은 속성들을 동적으로 변경할 수 있다. 동적 변경의 의미는 JEUS를 재시작하지 않더라도
      변경된 속성이 적용된다는 것이다.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Min</p>
        </li><li>
          <p>Max</p>
        </li><li>
          <p>Step</p>
        </li><li>
          <p>Period</p>
        </li><li>
          <p>Delegation Datasource</p>
        </li><li>
          <p>Keep Connection Handle Open</p>
        </li><li>
          <p>Max Use Count</p>
        </li><li>
          <p>Stmt Caching Size</p>
        </li><li>
          <p>Stmt Fetch Size</p>
        </li><li>
          <p>Use Sql Trace</p>
        </li><li>
          <p>Check Query</p>
        </li><li>
          <p>Check Query Timeout</p>
        </li><li>
          <p>Non Validation Interval</p>
        </li><li>
          <p>Check Query Period</p>
        </li><li>
          <p>Check Query Retrial Count</p>
        </li><li>
          <p>Destroy Policy On Check Query</p>
        </li><li>
          <p>Enable Wait</p>
        </li><li>
          <p>Wait Time</p>
        </li><li>
          <p>Connection Trace</p>

          <div class="itemizedlist"><ul type="circle"><li>
              <p>Enabled</p>
            </li></ul></div>
        </li></ul></div>

      <p>그러나 아래의 속성들은 동적 변경을 지원하지 않는다.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Delegation Dba</p>
        </li><li>
          <p>Dba Timeout</p>
        </li><li>
          <p>Check Query Class</p>
        </li></ul></div>
    </div>
  </div>
</div><div xmlns="" align="center"/></body></html>